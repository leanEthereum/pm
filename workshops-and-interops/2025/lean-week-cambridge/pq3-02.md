# pq3-02: LeanSig KeyGen & API

## Categories
- PQ-theory
- PQ-implementation

## Related Talks
- [pq3-01](pq3-01.md): PQ Ethereum Workshop - Day 3 Kickoff
- [pq1-04](pq1-04.md): Introduction to LeanSig
- [pq3-03](pq3-03.md): Proximity Prize

## Summary
Benedikt Wagner presented LeanSig KeyGen & API, proposing changes for flexibility. XMSS uses PRF seed for Merkle tree (pk=root); trade-off: store tree for fast signing or regenerate for small keys. Current API (KeyGen, Sign, Verify) restricts reuse per epoch; KeyGen slow (O(num_epochs + log L) hashes, L=2^32). Proposed API adds initial_aux (full/partial/empty tree), ExtendAux/NextAux for interval management ([a,b]). Discussions: deterministic Sign (no randomness); security (no reuse, client anti-slashing); withdrawal/exit (execution layer, reserve slots); multiple domains (pack messages, separate keys); usability (regenerate intervals offline).

## Key Takeaways
- XMSS: PRF seed generates tree; pk=root; balances key size/signing speed.
- Current API: Epoch-based; KeyGen ~days for full tree (~64 GiB sk); never reuse epoch.
- Proposed: Aux for tree parts; Extend/NextAux regenerate intervals (e.g., 3 days/2^16 slots <1s).
- Deterministic Sign: Reuse same message ok; different messages leak sk.
- Client flexibility: Choose storage/regeneration; library encapsulates crypto.
- Withdrawal: Execution layer; reserve last slot or pack exit messages.

## Speakers
- Benedikt Wagner (independent)

## Resources
- [Slides](https://drive.google.com/file/d/1P3JZ1SsfGsBQObkjkD8HNqFWC0DfE7vf/view?usp=drive_link)
- [Video](https://youtu.be/SOs3tVnyGv4)

> back to: [Index Page](index.md)

*Note: Summaries were generated in part with the help of AI, so names and terms may not be 100% accurate.*