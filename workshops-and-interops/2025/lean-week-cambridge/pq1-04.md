# pq1-04: Introduction to LeanSig

## Categories
- PQ-implementation

## Related Talks
- [pq1-06](pq1-06.md): XMSS Signature Aggregation
- [pq3-02](pq3-02.md): LeanSig KeyGen & API
- [pq3-06](pq3-06.md): New ZK-Friendly Encoding for Aggregatable XMSS Signatures
- [pq1-12](pq1-12.md): WHIR Performance

## Summary
Benedikt Wagner from the Ethereum Foundation's cryptography research team introduced LeanSig, a post-quantum hash-based signature scheme designed as a replacement for BLS in Ethereum's consensus layer. Developed collaboratively with Justin Drake, Dmitry Khovratovich, and Mikhail Kudinov, LeanSig builds on XMSS principles using Merkle trees and hash chains to transition from one-time to stateful many-time signatures, ensuring quantum resistance with minimal assumptions (relying solely on hash functions like Poseidon2). The scheme optimizes for aggregation efficiency in LeanMultisig via SNARKs, achieving ~3 KB signature sizes, tighter security proofs, and balanced trade-offs between size and verification hashing. Wagner highlighted the need for adaptive knowledge soundness in hash-based SNARKs and discussed open challenges like secret key management (store tree for fast signing vs. regenerate for small keys) and improving encodings to minimize big integer arithmetic in verification, which is currently the bottleneck.

## Key Takeaways
- **Post-Quantum Replacement**: LeanSig addresses BLS vulnerabilities by using hash-based constructions, enabling public, deterministic aggregation for multi-signatures in proof-of-stake.
- **XMSS-Inspired Design**: Employs one-time signatures extended via Merkle trees for synchronized signing per slot, fitting Ethereum's slashing mechanisms to prevent double-signing.
- **Efficiency Optimizations**: Achieves small signatures (~3 KB) to reduce bandwidth (e.g., avoiding 1 Gbps needs for 4,096 validators) and minimizes verifier hashing for SNARK-friendly aggregation.
- **Security and Simplicity**: Relies on minimal assumptions (hash function security), with modern proofs improving parameters; open to lattice alternatives if they meet requirements.
- **History and Resources**: Evolved from 2024 beam chain discussions; documented in ePrint papers (2025/055, 2025/889, 2025/1332) with a stable Rust prototype.
- **Open Questions**: Trade-offs in key size vs. signing speed (e.g., tree traversal algorithms); better encodings (new proposal by Khovratovich and Fenzi under evaluation); Poseidon2 cryptanalysis for overall integrity.

## Speakers
- Benedikt Wagner (EF - cryptography)

## Resources
- [Slides](https://drive.google.com/file/d/1bO3-eXZTsCfMy2QCqC3yiT2RNAlpdULx/view?usp=drive_link)
- ePrint Papers: [2025/055](https://eprint.iacr.org/2025/055), [2025/889](https://eprint.iacr.org/2025/889), [2025/1332](https://eprint.iacr.org/2025/1332)
- Rust Prototype (link via QR code in slides)
- [Video](https://youtu.be/d6ibWufnbjM)

> back to: [Index Page](index.md)

*Note: Summaries were generated in part with the help of AI, so names and terms may not be 100% accurate.*